CREATE TABLE GP16_HgP(
	STNNBR INT,
	lat FLOAT,
	lon FLOAT,
	depth INT,
	HgP_pmol_ug FLOAT,
	HgP_flag FLOAT,
	MMHgP_pmol_ug FLOAT,
	MMHgP_flag FLOAT,
	POC_umolC_L FLOAT,
	POC_sink_flag FLOAT,
	POC_susp_flag FLOAT
);

CREATE TABLE GP16_cleaned(
	STNNBR INT,
	depth FLOAT,
	lat FLOAT,
	long FLOAT,
	HgT_pM FLOAT,
	Hg0_pM FLOAT,
	MMHg_pM FLOAT,
	DMHg_pM FLOAT,
	SILCAT FLOAT,
	NITRAT FLOAT,
	NITRIT FLOAT,
	PHSPHT FLOAT,
	CTDPRS FLOAT,
	CTDTMP FLOAT,
	CTDSAL FLOAT,
	CTDOXY FLOAT,
	TRANSM FLOAT,
	FLUORM FLOAT
); 

SELECT *
FROM GP16_HgP JOIN GP16_cleaned ON GP16_HgP.STNNBR = GP16_cleaned.STNNBR
	AND GP16_cleaned.depth >= GP16_HgP.depth -5 
	AND GP16_cleaned.depth <= GP16_HgP.depth +5;